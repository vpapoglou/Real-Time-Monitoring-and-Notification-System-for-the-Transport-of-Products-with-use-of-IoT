//Handling the room temperature by sending IR signal to turn on/off the air-conditioner

//We set specific temperature values and check the ambient conditions through the DHT temperature and humidity sensor. We have set as desired room temperature the 20 Â° C and the //signal is sent per minute. If the conditions are not what we need, the Arduino board via IR Transmitter sends the appropriate signal either to turn on or off the air //conditioning.

#include <IRremote.hpp>
#include <dht.h>

#define dht_apin 2
#define IRledPin 13
#define NumIRsignals 200

dht DHT;

int IRsignalON[] = {

//put your own signal here
/*456, 454,
58, 164,
58, 52,
58, 166,
56, 164,
58, 54,
58, 52,
58, 164,
58, 54,
58, 52,
58, 164,
58, 54,
56, 54,
58, 164,
58, 164,
58, 54,
56, 166,
58, 164,
58, 52,
58, 164,
58, 164,
58, 164,
58, 164,
58, 164,
58, 164,
58, 54,
58, 164,
58, 52,
58, 54,
58, 52,
58, 54,
56, 54,
58, 52,
58, 166,
56, 54,
58, 164,
58, 164,
58, 164,
58, 164,
58, 54,
56, 54,
58, 54,
56, 164,
58, 54,
58, 52,
58, 54,
58, 52,
58, 164,
58, 164,
58, 536,
456, 456,
56, 166,
56, 54,
58, 164,
58, 164,
58, 52,
58, 54,
58, 164,
58, 52,
58, 54,
56, 166,
58, 52,
58, 54,
56, 166,
58, 164,
58, 52,
58, 164,
58, 164,
58, 54,
58, 164,
58, 164,
58, 164,
58, 164,
58, 164,
58, 164,
58, 54,
56, 164,
58, 54,
58, 52,
58, 54,
58, 52,
58, 54,
58, 52,
58, 164,
58, 54,
56, 166,
56, 166,
56, 166,
56, 166,
56, 54,
58, 52,
58, 54,
58, 164,
58, 52,
58, 54,
58, 52,
58, 54,
56, 166,
58, 164,
58, 0*/
};

int IRsignalOFF[] = {

//put your own signal here
/*458, 454,
58, 164,
58, 52,
58, 164,
58, 164,
58, 54,
58, 52,
58, 164,
58, 54,
56, 54,
58, 164,
58, 54,
56, 54,
58, 164,
58, 164,
58, 52,
58, 164,
58, 54,
58, 164,
58, 164,
58, 164,
58, 164,
58, 54,
56, 166,
56, 166,
58, 164,
58, 52,
58, 54,
58, 52,
58, 54,
56, 166,
58, 52,
58, 54,
56, 166,
56, 166,
56, 166,
56, 54,
58, 54,
56, 54,
58, 52,
58, 54,
58, 52,
58, 54,
58, 52,
58, 164,
58, 164,
58, 164,
58, 164,
58, 164,
58, 536,
456, 454,
58, 164,
58, 54,
58, 164,
58, 164,
58, 52,
58, 54,
58, 164,
58, 52,
58, 54,
58, 164,
58, 52,
58, 54,
58, 164,
58, 164,
58, 52,
58, 164,
58, 54,
58, 164,
56, 166,
56, 166,
58, 164,
58, 52,
58, 164,
58, 164,
58, 164,
58, 54,
58, 52,
58, 54,
58, 52,
58, 164,
58, 54,
56, 54,
58, 164,
58, 164,
58, 164,
58, 52,
58, 54,
58, 52,
58, 54,
58, 52,
58, 54,
58, 52,
58, 54,
58, 164,
56, 166,
58, 164,
58, 164,
58, 164,
58, 0*/
};

void setup() {
  digitalWrite(IRledPin, LOW); 
  pinMode(IRledPin, OUTPUT); 
  Serial.begin(9600);        
}

void loop() {
    DHT.read11(dht_apin);

    Serial.print("Current humidity = ");
    Serial.print(DHT.humidity);
    Serial.print("%  ");
    Serial.print("temperature = ");
    Serial.print(DHT.temperature); 
    Serial.print("C ~ ");
    Serial.print(DHT.temperature*1.8 + 32);
    Serial.println("F");

    if(DHT.temperature < 19)
    {
      Serial.println("Temperature low --> AC powered on");
      for (int i = 0; i < NumIRsignals; i+=2) 
      {         
      pulseIR(IRsignalON[i]*10);              
      delayMicroseconds(IRsignalON[i+1]*10);  
      }
    }

    if(DHT.temperature > 19)
    {
      Serial.println("Temperature high --> AC powered off");
      for (int i = 0; i < NumIRsignals; i+=2) 
      {         
      pulseIR(IRsignalOFF[i]*10);              
      delayMicroseconds(IRsignalOFF[i+1]*10); 
      }
    }
    delay(60000);
}
   
void pulseIR(long microsecs) {
  
  cli();  
 
  while (microsecs > 0) {
    
   digitalWrite(IRledPin, HIGH); 
   delayMicroseconds(10);         
   digitalWrite(IRledPin, LOW);   
   delayMicroseconds(10);         
 
   microsecs -= 26;
  }
 
  sei();  
}
